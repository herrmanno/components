var ho;!function(t){var e;!function(e){var n;!function(e){var n=t.promise.Promise;e.mapping={};var o=function(){function t(){this.useMin=!1}return t.prototype.resolve=function(t){return t=t.split(".").join("/"),this.useMin?"components/"+t+".min.js":"components/"+t+".js"},t.prototype.getComponent=function(t){var o=this;return new n(function(n,r){var i=e.mapping[t]||o.resolve(t),s=document.createElement("script");s.onload=function(){"function"==typeof this.get(t)?n(this.get(t)):r("Error while loading Component "+t)}.bind(o),s.src=i,document.getElementsByTagName("head")[0].appendChild(s)})},t.prototype.get=function(t){var e=window;return t.split(".").forEach(function(t){e=e[t]}),e},t}();e.ComponentProvider=o,e.instance=new o}(n=e.componentprovider||(e.componentprovider={}))}(e=t.components||(t.components={}))}(ho||(ho={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);n.prototype=e.prototype,t.prototype=new n},ho;!function(t){var e;!function(e){var n=function(){function t(t,n){this.element=t,this.component=e.Component.getComponent(t),this.value=n,this.init()}return t.prototype.init=function(){},Object.defineProperty(t.prototype,"name",{get:function(){return t.getName(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(){},t.getName=function(e){return e instanceof t?e.constructor.toString().match(/\w+/g)[1]:e.toString().match(/\w+/g)[1]},t}();e.Attribute=n;var o=function(e){function n(t,n){e.call(this,t,n),this.r=/#(.+?)#/g;var o=this.value.match(this.r)||[];o.map(function(t){t=t.substr(1,t.length-2),this.watch(t)}.bind(this)),this.value=this.value.replace(/#/g,"")}return __extends(n,e),n.prototype.watch=function(e){var n=e.split("."),o=n.pop(),r=this.component;n.map(function(t){r=r[t]}),t.watch.watch(r,o,this.update.bind(this))},n.prototype.eval=function(t){var e=this.component;return e=new Function(Object.keys(e).toString(),"return "+t).apply(null,Object.keys(e).map(function(t){return e[t]}))},n}(n);e.WatchAttribute=o}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(e){var n;!function(e){var n=t.promise.Promise,o=function(){function t(){this.useMin=!1}return t.prototype.resolve=function(t){return this.useMin?"attributes/"+t+".min.js":"attributes/"+t+".js"},t.prototype.getAttribute=function(t){var e=this;return new n(function(n,o){var r=e.resolve(t),i=document.createElement("script");i.onload=function(){"function"==typeof window[t]?n(window[t]):o("Error while loading Attribute "+t)},i.src=r,document.getElementsByTagName("head")[0].appendChild(i)})},t}();e.AttributeProvider=o,e.instance=new o}(n=e.attributeprovider||(e.attributeprovider={}))}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(e){var n;!function(n){var o=t.promise.Promise,r=function(){function n(){this.components=[],this.attributes=[]}return n.prototype.register=function(t){t.prototype instanceof e.Component?(this.components.push(t),document.createElement(e.Component.getName(t))):t.prototype instanceof e.Attribute&&this.attributes.push(t)},n.prototype.run=function(){var t=this.initComponent.bind(this),e=this.components.map(function(e){return t(e)});return o.all(e)},n.prototype.initComponent=function(t,n){void 0===n&&(n=document);var r=Array.prototype.map.call(n.querySelectorAll(e.Component.getName(t)),function(e){return new t(e)._init()});return o.all(r)},n.prototype.initElement=function(t){var e=this;this.components.forEach(function(n){e.initComponent(n,t)})},n.prototype.hasComponent=function(t){return this.components.filter(function(n){return e.Component.getName(n)===t}).length>0},n.prototype.hasAttribute=function(t){return this.attributes.filter(function(n){return e.Attribute.getName(n)===t}).length>0},n.prototype.getAttribute=function(t){return this.attributes.filter(function(n){return e.Attribute.getName(n)===t})[0]},n.prototype.loadComponent=function(e){var n=this;return this.getParentOfComponent(e).then(function(t){return n.hasComponent(t)||"ho.components.Component"===t?!0:n.loadComponent(t)}).then(function(n){return t.components.componentprovider.instance.getComponent(e)}).then(function(t){return n.register(t),t})},n.prototype.getParentOfComponent=function(e){return new o(function(n,o){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState){var t=r.responseText;if(200==r.status){var e=t.match(/}\)\((.*)\);/);n(null!==e?e[1]:null)}else o(t)}},r.open("GET",t.components.componentprovider.instance.resolve(e)),r.send()})},n.prototype.loadAttribute=function(e){var n=this;return new o(function(o,r){t.components.attributeprovider.instance.getAttribute(e).then(function(t){n.register(t),o(t)})})},n}();n.Registry=r,n.instance=new r}(n=e.registry||(e.registry={}))}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(e){function n(){return t.components.registry.instance.run()}function o(e){t.components.registry.instance.register(e)}e.run=n,e.register=o}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(e){var n;!function(e){var n=t.promise.Promise,o=function(){function t(){this.cache={}}return t.prototype.resolve=function(t){return"components/"+t+".html"},t.prototype.getHTML=function(t){var e=this;return new n(function(n,o){if("string"==typeof e.cache[t])return n(e.cache[t]);var r=e.resolve(t),i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState){var e=i.responseText;200==i.status?n(e):o("Error while loading html for Component "+t)}},i.open("GET",r,!0),i.send()})},t}();e.HtmlProvider=o,e.instance=new o}(n=e.htmlprovider||(e.htmlprovider={}))}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(t){var e;!function(t){function e(t){return r++,i[r]=t,r}function n(t){return i[t]}function o(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];i[t].apply(i,e)}var r=-1,i=[];t.set=e,t.get=n,t.call=o}(e=t.temp||(t.temp={}))}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(e){var n;!function(e){var n=t.components.registry.instance,o=function(){function t(){this.children=[]}return t}(),r=function(){function e(){this.r={tag:/<([^>]*?(?:(?:('|")[^'"]*?\2)[^>]*?)*)>/,repeat:/repeat=["|'].+["|']/,type:/[\s|/]*(.*?)[\s|\/|>]/,text:/(?:.|[\r\n])*?[^"'\\]</m},this.voids=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],this.cache={}}return e.prototype.render=function(t){if("boolean"!=typeof t.html||t.html){var e=t.name,n=this.cache[e]=this.cache[e]||this.parse(t.html).root;n=this.renderRepeat(this.copyNode(n),t);var o=this.domToString(n,-1);t.element.innerHTML=o}},e.prototype.parse=function(t,e){void 0===e&&(e=new o);for(var r;null!==(r=this.r.tag.exec(t));){var i,s,a,c,p,u,h;if(0!==r.index?(i=t.match(this.r.text)[0],i=i.substr(0,i.length-1),s="TEXT",c=!1,p=!0,u=!1):(i=r[1].trim(),s=(i+">").match(this.r.type)[1],a="/"===i[0],c=this.isVoid(s),p=c||"/"===i[i.length-1],u=!!i.match(this.r.repeat),p&&n.hasComponent(s)&&(p=!1,i=i.substr(0,i.length-1)+" ",h=!0)),t=t.slice(i.length+("TEXT"===s?0:2)),a)break;if(e.children.push({parent:e,html:i,type:s,isVoid:c,selfClosing:p,repeat:u,children:[]}),!h&&!p){var l=this.parse(t,e.children[e.children.length-1]);t=l.html,e.children.pop(),e.children.push(l.root)}r=t.match(this.r.tag)}return{root:e,html:t}},e.prototype.renderRepeat=function(t,e){e=[].concat(e);for(var n=0;n<t.children.length;n++){var o=t.children[n];if(o.repeat){var r,i=/repeat=["|']\s*(\S+)\s+as\s+(\S+?)["|']/,s=o.html.match(i).slice(1),a=s[1];if(a.indexOf(",")>-1){var c=a.split(",");a=c[0].trim(),r=c[1].trim()}var p=this.evaluate(e,s[0]),u=[];p.forEach(function(t,n){var i={};i[a]=t,i[r]=n;var s=[].concat(e);s.unshift(i);var c=this.copyNode(o);c.repeat=!1,c.html=c.html.replace(this.r.repeat,""),c.html=this.repl(c.html,s),c=this.renderRepeat(c,s),u.push(c)}.bind(this)),u.forEach(function(e){t.children.splice(t.children.indexOf(o),0,e)}),t.children.splice(t.children.indexOf(o),1)}else o.html=this.repl(o.html,e),o=this.renderRepeat(o,e),t.children[n]=o}return t},e.prototype.domToString=function(t,e){e=e||0;var n="",o="	";return t.html&&(n+=new Array(e).join(o),n+="TEXT"!==t.type?t.selfClosing&&!t.isVoid?"<"+t.html+"/>":"<"+t.html+">":t.html),n&&(n+="\n"),t.children.length&&(n+=t.children.map(function(n){return this.domToString(n,e+(t.type?1:2))}.bind(this)).join("\n")),t.type&&"TEXT"!==t.type&&!t.selfClosing&&(n+=new Array(e).join(o),n+="</"+t.type+">\n"),n},e.prototype.repl=function(t,e){var n=/{(.+?)}}?/g,o=t.match(n);if(!o)return t;for(;o.length;){var r=o[0];r=r.substr(1,r.length-2);var i=this.evaluate(e,r);void 0!==i&&("function"==typeof i&&(i="ho.components.Component.getComponent(this)."+r),t=t.replace(o[0],i)),o=o.slice(1)}return t},e.prototype.evaluate=function(t,e){return"{"===e[0]&&"}"===e[--e.length]?this.evaluateExpression(t,e.substr(1,e.length-2)):"#"===e[0]?this.evaluateFunction(t,e.substr(1)):this.evaluateValue(t,e)},e.prototype.evaluateValue=function(t,e){return this.evaluateValueAndModel(t,e).value},e.prototype.evaluateValueAndModel=function(t,e){-1==t.indexOf(window)&&t.push(window);for(var n=0,o=void 0;n<t.length&&void 0===o;){o=t[n];try{o=new Function("model","return model['"+e.split(".").join("']['")+"']")(o)}catch(r){o=void 0}finally{n++}}return{value:o,model:t[--n]}},e.prototype.evaluateExpression=function(t,e){-1==t.indexOf(window)&&t.push(window);for(var n=0,o=void 0;n<t.length&&void 0===o;){o=t[n];try{o=new Function(Object.keys(o).toString(),"return "+e).apply(null,Object.keys(o).map(function(t){return o[t]}))}catch(r){o=void 0}finally{n++}}return o},e.prototype.evaluateFunction=function(e,n){var o=this.evaluateExpression.bind(this,e),r=n.split("("),i=r[0],s=r[1];s=s.substr(0,--s.length);var a=this.evaluateValueAndModel(e,i),c=a.value,p=a.model,u=c,h=s.split(".").map(function(t){return 0===t.indexOf("#")?t.substr(1):o(t)});u=u.bind.apply(u,[p].concat(h));var l=t.components.temp.set(u),m="ho.components.temp.call("+l+")";return m},e.prototype.copyNode=function(t){var e=this.copyNode.bind(this),n={parent:t.parent,html:t.html,type:t.type,selfClosing:t.selfClosing,repeat:t.repeat,children:t.children.map(e)};return n},e.prototype.isVoid=function(t){return-1!==this.voids.indexOf(t.toLowerCase())},e}();e.Renderer=r,e.instance=new r}(n=e.renderer||(e.renderer={}))}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(e){var n=t.components.registry.instance,o=t.components.htmlprovider.instance,r=t.components.renderer.instance,i=t.promise.Promise,s=function(){function t(t){this.properties=[],this.attributes=[],this.requires=[],this.children={},this.element=t,this.element.component=this,this.original_innerHTML=t.innerHTML}return Object.defineProperty(t.prototype,"name",{get:function(){return t.getName(this)},enumerable:!0,configurable:!0}),t.prototype.getName=function(){return this.name},t.prototype.getParent=function(){return t.getComponent(this.element.parentNode)},t.prototype._init=function(){var t=this.render.bind(this);this.initProperties();var e=[this.initHTML(),i.create(this.init()),this.loadRequirements()],n=new i;return i.all(e).then(function(){n.resolve(),t()})["catch"](function(t){throw n.reject(t),t}),n},t.prototype.init=function(){},t.prototype.update=function(){return void 0},t.prototype.render=function(){r.render(this),n.initElement(this.element),this.initChildren(),this.initAttributes(),this.update()},t.prototype.initHTML=function(){var t=new i,e=this;return"boolean"==typeof this.html&&t.resolve(),"string"==typeof this.html&&t.resolve(),"undefined"==typeof this.html&&o.getHTML(this.name).then(function(n){e.html=n,t.resolve()})["catch"](t.reject),t},t.prototype.initProperties=function(){this.properties.forEach(function(t){if("object"==typeof t){if(this.properties[t.name]=this.element[t.name]||this.element.getAttribute(t.name)||t["default"],void 0===this.properties[t.name]&&t.required===!0)throw"Property "+t.name+" is required but not provided"}else"string"==typeof t&&(this.properties[t]=this.element[t]||this.element.getAttribute(t))}.bind(this))},t.prototype.initChildren=function(){for(var t=this.element.querySelectorAll("*"),e=0;e<t.length;e++){var n=t[e];n.id&&(this.children[n.id]=n),n.tagName&&(this.children[n.tagName]=this.children[n.tagName]||[]),this.children[n.tagName].push(n)}},t.prototype.initAttributes=function(){var t=this;this.attributes.forEach(function(e){var o=n.getAttribute(e);Array.prototype.forEach.call(t.element.querySelectorAll("*["+e+"]"),function(t){var n=t.hasOwnProperty(e)?t[e]:t.getAttribute(e);"string"==typeof n&&""===n&&(n=void 0),new o(t,n).update()})})},t.prototype.loadRequirements=function(){var t=this.requires.filter(function(t){return!n.hasComponent(t)}).map(function(t){return n.loadComponent(t)}),e=this.attributes.filter(function(t){return!n.hasAttribute(t)}).map(function(t){return n.loadAttribute(t)}),o=t.concat(e);return i.all(o)},t.getComponent=function(t){for(;!t.component;)t=t.parentNode;return t.component},t.getName=function(e){return e instanceof t?e.constructor.toString().match(/\w+/g)[1]:e.toString().match(/\w+/g)[1]},t}();e.Component=s}(e=t.components||(t.components={}))}(ho||(ho={}));