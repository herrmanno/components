var ho;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.getHTML=function(t){return new Promise(function(e,n){var o="components/"+t+".html",r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState){var t=r.responseText;200==r.status?e(t):n(t)}},r.open("GET",o,!0),r.send()})},t}();t.HtmlProvider=e}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(t){var e=function(){function e(){}return e.prototype.getComponent=function(e){return new Promise(function(n,o){var r="components/"+e+".js",i=document.createElement("script");i.onload=function(){t.Component.register(window[e]),n()},i.src=r,document.getElementsByTagName("head")[0].appendChild(i)})},e}();t.ComponentProvider=e}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(t){var e;!function(t){function e(t){return r++,i[r]=t,r}function n(t){return i[t]}function o(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];i[t].apply(i,e)}var r=-1,i=[];t.set=e,t.get=n,t.call=o}(e=t.temp||(t.temp={}))}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(e){var n=function(){function t(){this.children=[]}return t}(),o=function(){function o(){this.r={tag:/<([^>]*?(?:(?:('|")[^'"]*?\2)[^>]*?)*)>/,repeat:/repeat=["|'].+["|']/,type:/[\s|/]*(.*?)[\s|\/|>]/,text:/(?:.|[\r\n])*?[^"'\\]</m},this.cache={}}return o.prototype.render=function(t){if("boolean"!=typeof t.html||t.html){var n=e.Component.getName(t),o=this.cache[n]=this.cache[n]||this.parse(t.html).root;o=this.renderRepeat(this.copyNode(o),t);var r=this.domToString(o,-1);t.element.innerHTML=r}},o.prototype.parse=function(t,o){void 0===o&&(o=new n);for(var r;null!==(r=this.r.tag.exec(t));){var i,s,p,h,a,c;if(0!==r.index?(i=t.match(this.r.text)[0],i=i.substr(0,i.length-1),s="TEXT",h=!0,a=!1):(i=r[1].trim(),s=(i+">").match(this.r.type)[1],p="/"===i[0],h="/"===i[i.length-1],a=!!i.match(this.r.repeat),h&&e.Component.registry.hasComponent(s)&&(h=!1,i=i.substr(0,i.length-1)+" ",c=!0)),t=t.slice(i.length+("TEXT"===s?0:2)),p)break;if(o.children.push({parent:o,html:i,type:s,selfClosing:h,repeat:a,children:[]}),!c&&!h){var u=this.parse(t,o.children[o.children.length-1]);t=u.html,o.children.pop(),o.children.push(u.root)}r=t.match(this.r.tag)}return{root:o,html:t}},o.prototype.renderRepeat=function(t,e){e=[].concat(e);for(var n=0;n<t.children.length;n++){var o=t.children[n];if(o.repeat){var r,i=/repeat=["|']\s*(\S+)\s+as\s+(\S+?)["|']/,s=o.html.match(i).slice(1),p=s[1];if(p.indexOf(",")>-1){var h=p.split(",");p=h[0].trim(),r=h[1].trim()}var a=this.evaluate(e,s[0]),c=[];a.forEach(function(t,n){var i={};i[p]=t,i[r]=n;var s=[].concat(e);s.unshift(i);var h=this.copyNode(o);h.repeat=!1,h.html=h.html.replace(this.r.repeat,""),h.html=this.repl(h.html,s),h=this.renderRepeat(h,s),c.push(h)}.bind(this)),c.forEach(function(e){t.children.splice(t.children.indexOf(o),0,e)}),t.children.splice(t.children.indexOf(o),1)}else o.html=this.repl(o.html,e),o=this.renderRepeat(o,e),t.children[n]=o}return t},o.prototype.domToString=function(t,e){e=e||0;var n="",o="	";return t.html&&(n+=o.repeat(e),n+="TEXT"!==t.type?"<"+t.html+">":t.html),n&&(n+="\n"),t.children.length&&(n+=t.children.map(function(n){return this.domToString(n,e+(t.type?1:2))}.bind(this)).join("\n")),t.type&&"TEXT"!==t.type&&!t.selfClosing&&(n+=o.repeat(e),n+="</"+t.type+">\n"),n},o.prototype.evaluate=function(t,e){return"{"===e[0]&&"}"===e[--e.length]?this.evaluateExpression(t,e.substr(1,e.length-2)):"#"===e[0]?this.evaluateFunction(t,e.substr(1)):this.evaluateValue(t,e)},o.prototype.evaluateValue=function(t,e){return this.evaluateValueAndModel(t,e).value},o.prototype.evaluateValueAndModel=function(t,e){-1==t.indexOf(window)&&t.push(window);for(var n=0,o=void 0;n<t.length&&void 0===o;){o=t[n];try{o=new Function("model","return model['"+e.split(".").join("']['")+"']")(o)}catch(r){o=void 0}finally{n++}}return{value:o,model:t[--n]}},o.prototype.evaluateExpression=function(t,e){-1==t.indexOf(window)&&t.push(window);for(var n=0,o=void 0;n<t.length&&void 0===o;){o=t[n];try{o=new Function(Object.keys(o).toString(),"return "+e).apply(null,Object.keys(o).map(function(t){return o[t]}))}catch(r){o=void 0}finally{n++}}return o},o.prototype.evaluateFunction=function(e,n){var o=this.evaluateExpression.bind(this,e),r=n.split("("),i=r[0],s=r[1];s=s.substr(0,--s.length);var p=this.evaluateValueAndModel(e,i),h=p.value,a=p.model,c=h,u=s.split(".").map(function(t){return 0===t.indexOf("#")?t.substr(1):o(t)});c=c.bind.apply(c,[a].concat(u));var l=t.components.temp.set(c),m="ho.components.temp.call("+l+")";return m},o.prototype.copyNode=function(t){var e=this.copyNode.bind(this),n={parent:t.parent,html:t.html,type:t.type,selfClosing:t.selfClosing,repeat:t.repeat,children:t.children.map(e)};return n},o.prototype.repl=function(t,e){var n=/{(.+?)}}?/g,o=t.match(n);if(!o)return t;for(;o.length;){var r=o[0];r=r.substr(1,r.length-2);var i=this.evaluate(e,r);void 0!==i&&("function"==typeof i&&(i="ho.components.Component.getComponent(this)."+r),t=t.replace(o[0],i)),o=o.slice(1)}return t},o}();e.Renderer=o}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(t){var e=function(){function e(e){var n=this;if(this.htmlProvider=new t.HtmlProvider,this.componentProvider=new t.ComponentProvider,this.renderer=new t.Renderer,e){var o=["htmlProvider","componentProvider","renderer"];o.forEach(function(t){e.hasOwnAttribute(t)&&(n[t]=e[t])})}}return e}();t.RegistryOptions=e}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(t){var e=function(){function e(e){this.components=[],this.htmlMap={},this.options=new t.RegistryOptions(e)}return e.prototype.setOptions=function(e){this.options=new t.RegistryOptions(e)},e.prototype.register=function(e){this.components.push(e),document.createElement(t.Component.getName(e))},e.prototype.run=function(){var t=this;this.components.forEach(function(e){t.initComponent(e)})},e.prototype.initComponent=function(e,n){void 0===n&&(n=document),Array.prototype.forEach.call(n.querySelectorAll(t.Component.getName(e)),function(t){new e(t)._init()})},e.prototype.initElement=function(t){var e=this;this.components.forEach(function(n){e.initComponent(n,t)})},e.prototype.hasComponent=function(e){return this.components.filter(function(n){return t.Component.getName(n)===e}).length>0},e.prototype.loadComponent=function(t){return this.options.componentProvider.getComponent(t)},e.prototype.getHtml=function(t){var e=new Promise;return void 0!==this.htmlMap[t]?e.resolve(this.htmlMap[t]):this.options.htmlProvider.getHTML(t).then(function(t){e.resolve(t)}),e},e.prototype.render=function(t){this.options.renderer.render(t)},e}();t.Registry=e}(e=t.components||(t.components={}))}(ho||(ho={}));var Promise=ho.promise.Promise,ho;!function(t){var e;!function(t){var e=function(){function e(t){this.properties=[],this.property={},this.requires=[],this.children={},this.element=t,this.element.component=this,this.original_innerHTML=t.innerHTML}return e.prototype.getParent=function(){return e.getComponent(this.element.parentNode)},e.prototype._init=function(){var t=this.render.bind(this);this.initProperties();var e=[this.initHTML(),Promise.create(this.init()),this.loadRequirements()];Promise.all(e).then(function(){t()})["catch"](function(t){throw t})},e.prototype.init=function(){},e.prototype.update=function(){return void 0},e.prototype.render=function(){e.registry.render(this),this.update(),this.initChildren(),e.registry.initElement(this.element)},e.prototype.initHTML=function(){var t=new Promise,n=this;if("boolean"==typeof this.html&&t.resolve(),"string"==typeof this.html&&t.resolve(),"undefined"==typeof this.html){var o=e.getName(this);e.registry.getHtml(o).then(function(e){n.html=e,t.resolve()})["catch"](t.reject)}return t},e.prototype.initProperties=function(){this.properties.forEach(function(t){if("object"==typeof t){if(this.properties[t.name]=this.element[t.name]||this.element.getAttribute(t.name)||t["default"],void 0===this.properties[t.name]&&t.required===!0)throw"Property "+t.name+" is required but not provided"}else"string"==typeof t&&(this.properties[t]=this.element[t]||this.element.getAttribute(t))}.bind(this))},e.prototype.initChildren=function(){for(var t=this.element.querySelectorAll("*"),e=0;e<t.length;e++){var n=t[e];n.id&&(this.children[n.id]=n),this.children[n.tagName]=this.children[n.tagName]||[],this.children[n.tagName].push(n)}},e.prototype.loadRequirements=function(){var t=this.requires.filter(function(t){return!e.registry.hasComponent(t)}).map(function(t){return e.registry.loadComponent(t)});return Promise.all(t)},e.register=function(t){e.registry.register(t)},e.run=function(t){e.registry.setOptions(t),e.registry.run()},e.getComponent=function(t){for(;!t.component;)t=t.parentNode;return t.component},e.getName=function(t){return t instanceof e?t.constructor.toString().match(/\w+/g)[1]:t.toString().match(/\w+/g)[1]},e.registry=new t.Registry,e}();t.Component=e}(e=t.components||(t.components={}))}(ho||(ho={}));